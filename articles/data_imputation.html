<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Imputation ‚Ä¢ HDAnalyzeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Imputation">
</head>
<body>
<p>








  pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HDAnalyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/HDAnalyzeR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/before_using_hdanalyzer.html">Data Preparation for HDAnalyzeR: What You Need Before Using the Package</a></li>
    <li><a class="dropdown-item" href="../articles/data_preprocessing.html">Data Preprocessing &amp; Quality Control Check</a></li>
    <li><a class="dropdown-item" href="../articles/data_imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/differential_expression.html">Differential Expression Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Machine Learning Models</a></li>
    <li><a class="dropdown-item" href="../articles/post_analysis.html">Post Analysis: Pathway Enrichment &amp; Automated Literature Search</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/HDA1472/HDAnalyzeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data Imputation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HDA1472/HDAnalyzeR/blob/main/vignettes/data_imputation.Rmd" class="external-link"><code>vignettes/data_imputation.Rmd</code></a></small>
      <div class="d-none name"><code>data_imputation.Rmd</code></div>
    </div>

    
    
<p>This vignette will guide you to the different imputation methods
HDAnalyzeR offers. First of all, we will load the package, as well as
dplyr, ggplot2 and patchwork for data manipulation and visualization. We
will also load and widen the Olink example dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hda1472.github.io/HDAnalyzeR">HDAnalyzeR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="loading-the-data">Loading the Data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<p>Let‚Äôs start with loading the example data and metadata that come with
the package and initialize the HDAnalyzeR object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_initialize.html">hd_initialize</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">example_data</span>, </span>
<span>                        metadata <span class="op">=</span> <span class="va">example_metadata</span>, </span>
<span>                        is_wide <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                        sample_id <span class="op">=</span> <span class="st">"DAid"</span>,</span>
<span>                        var_name <span class="op">=</span> <span class="st">"Assay"</span>,</span>
<span>                        value_name <span class="op">=</span> <span class="st">"NPX"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="explore-missing-values">Explore Missing Values<a class="anchor" aria-label="anchor" href="#explore-missing-values"></a>
</h2>
<p>We can simply check our data for NA values by using the
<code><a href="../reference/hd_qc_summary.html">hd_qc_summary()</a></code> as we did in previous vignettes. This time
we will use something specific to NA</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">na_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_na_search.html">hd_na_search</a></span><span class="op">(</span><span class="va">hd_obj</span>,</span>
<span>                       annotation_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span>, <span class="st">"Disease"</span><span class="op">)</span>,</span>
<span>                       palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Disease <span class="op">=</span> <span class="st">"cancers12"</span>,</span>
<span>                                      Sex <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>                       x_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       y_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">na_res</span><span class="op">$</span><span class="va">na_heatmap</span></span></code></pre></div>
<p><img src="data_imputation_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>This heatmap is useful to evaluate if there are NA specific patterns
in the data. In this case, we can see that the NA values are spread
across the different Assays, samples and metadata variables. In this
case, we can try impute them!</p>
</div>
<div class="section level2">
<h2 id="imputation-methods">Imputation Methods<a class="anchor" aria-label="anchor" href="#imputation-methods"></a>
</h2>
<div class="section level3">
<h3 id="median-imputation">Median Imputation<a class="anchor" aria-label="anchor" href="#median-imputation"></a>
</h3>
<p>We will start the imputation with the simplest and fastest method,
which is the median imputation by using the
<code><a href="../reference/hd_impute_median.html">hd_impute_median()</a></code>. After the imputation, we will check the
sample distribution of a random Assay that contains missing values to
see if these values are imputed logically.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imputed_hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_impute_median.html">hd_impute_median</a></span><span class="op">(</span><span class="va">hd_obj</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">&lt;-</span> <span class="va">hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Before imputation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_after</span> <span class="op">&lt;-</span> <span class="va">imputed_hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightpink"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"After median imputation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">+</span> <span class="va">plot_after</span></span></code></pre></div>
<p><img src="data_imputation_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>As observed in the plots, the distribution of the ACTA2 assay shifts
slightly after imputation, with an exaggerated median value in the
imputed data. This highlights a key drawback of median imputation: the
more missing values there are, the greater the potential bias.</p>
</div>
<div class="section level3">
<h3 id="knn-imputation">KNN Imputation<a class="anchor" aria-label="anchor" href="#knn-imputation"></a>
</h3>
<p>A better approach is to use the <code><a href="../reference/hd_impute_knn.html">hd_impute_knn()</a></code> with 5
neighbors, which imputes missing values based on the 5-nearest
neighbors. We will use the same assay to compare the imputed data with
the original data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imputed_hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_impute_knn.html">hd_impute_knn</a></span><span class="op">(</span><span class="va">hd_obj</span>, k <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">&lt;-</span> <span class="va">hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Before imputation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_after</span> <span class="op">&lt;-</span> <span class="va">imputed_hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightpink"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"After KNN imputation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">+</span> <span class="va">plot_after</span></span></code></pre></div>
<p><img src="data_imputation_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>In this case, the distribution of the ACTA2 assay after imputation is
more similar to the original distribution. This is because the KNN
imputation method uses the nearest neighbors to impute missing values,
which is more accurate and representative than median imputation.</p>
</div>
<div class="section level3">
<h3 id="missforest-imputation">MissForest Imputation<a class="anchor" aria-label="anchor" href="#missforest-imputation"></a>
</h3>
<p>Finally, we will use the <code><a href="../reference/hd_impute_missForest.html">hd_impute_missForest()</a></code> method,
which uses the random forest algorithm to impute missing values. We will
use the default values for the number of trees and the number of
iterations.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imputed_hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_impute_missForest.html">hd_impute_missForest</a></span><span class="op">(</span><span class="va">hd_obj</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">&lt;-</span> <span class="va">hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Before imputation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_after</span> <span class="op">&lt;-</span> <span class="va">imputed_hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightpink"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"After MissForest imputation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">+</span> <span class="va">plot_after</span></span></code></pre></div>
<p><img src="data_imputation_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The MissForest imputation method is the most accurate and also very
robust, as it uses the random forest algorithm to impute missing values.
This method is particularly useful for large datasets with complex
relationships between variables. On the other hand, it is the most
computationally expensive and it would help parallelize it. You can do
that by creating and registering a cluster with a package like
<code>doParallel</code> and then setting the <code>parallelize</code>
argument to ‚Äúforests‚Äù or ‚Äúvariables‚Äù.</p>
<blockquote>
<p>üìì All methods assume that the data is missing at random, which is a
common assumption in imputation methods. If the data are missing in a
biased way (either technical or biological), the imputation methods may
introduce bias into the data. In such cases, it is important to
carefully consider the way the data were collected and what they
represent.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="removing-missing-values-instead-of-imputing">Removing Missing Values instead of Imputing<a class="anchor" aria-label="anchor" href="#removing-missing-values-instead-of-imputing"></a>
</h2>
<p>If for any reason do not want to impute the data, you can use the
<code><a href="../reference/hd_omit_na.html">hd_omit_na()</a></code> function to remove the rows with missing
values in specific variables. This function will remove all rows with
missing values in any of the assays.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imputed_hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_omit_na.html">hd_omit_na</a></span><span class="op">(</span><span class="va">hd_obj</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">&lt;-</span> <span class="va">hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Before imputation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_after</span> <span class="op">&lt;-</span> <span class="va">imputed_hd_obj</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ACTA2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightpink"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"After removing missing values"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"ACTA2"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_before</span> <span class="op">+</span> <span class="va">plot_after</span></span></code></pre></div>
<p><img src="data_imputation_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Data after removing missing values only in specific columns</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_omit_na.html">hd_omit_na</a></span><span class="op">(</span><span class="va">hd_obj</span>, columns <span class="op">=</span> <span class="st">"AARSD1"</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 552 √ó 101</span></span></span>
<span><span class="co">#&gt;    DAid    AARSD1  ABL1  ACAA1    ACAN    ACE2  ACOX1    ACP5    ACP6 ACTA2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> DA00001   3.39 2.76   1.71   0.033<span style="text-decoration: underline;">3</span>  1.76   -<span style="color: #BB0000;">0.919</span>  1.54    2.15   2.81 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> DA00002   1.42 1.25  -<span style="color: #BB0000;">0.816</span> -<span style="color: #BB0000;">0.459</span>   0.826  -<span style="color: #BB0000;">0.902</span>  0.647   1.30   0.798</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> DA00004   3.41 3.38   1.69  <span style="color: #BB0000;">NA</span>       1.52   <span style="color: #BB0000;">NA</span>      0.841   0.582  1.70 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> DA00005   5.01 5.05   0.128  0.401  -<span style="color: #BB0000;">0.933</span>  -<span style="color: #BB0000;">0.584</span>  0.026<span style="text-decoration: underline;">5</span>  1.16   2.73 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> DA00006   6.83 1.18  -<span style="color: #BB0000;">1.74</span>  -<span style="color: #BB0000;">0.156</span>   1.53   -<span style="color: #BB0000;">0.721</span>  0.620   0.527  0.772</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> DA00008   2.78 0.812 -<span style="color: #BB0000;">0.552</span>  0.982  -<span style="color: #BB0000;">0.101</span>  -<span style="color: #BB0000;">0.304</span>  0.376  -<span style="color: #BB0000;">0.826</span>  1.52 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> DA00009   4.39 3.34  -<span style="color: #BB0000;">0.452</span> -<span style="color: #BB0000;">0.868</span>   0.395   1.71   1.49   -<span style="color: #BB0000;">0.028</span><span style="color: #BB0000; text-decoration: underline;">5</span> 0.200</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> DA00010   1.83 1.21  -<span style="color: #BB0000;">0.912</span> -<span style="color: #BB0000;">1.04</span>   -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.304</span>  1.69    0.092<span style="text-decoration: underline;">0</span> 2.04 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> DA00011   3.48 4.96   3.50  -<span style="color: #BB0000;">0.338</span>   4.48    1.26   2.18    1.62   1.79 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DA00012   4.31 0.710 -<span style="color: #BB0000;">1.44</span>  -<span style="color: #BB0000;">0.218</span>  -<span style="color: #BB0000;">0.469</span>  -<span style="color: #BB0000;">0.361</span> -<span style="color: #BB0000;">0.071</span><span style="color: #BB0000; text-decoration: underline;">4</span> -<span style="color: #BB0000;">1.30</span>   2.86 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 542 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 91 more variables: ACTN4 &lt;dbl&gt;, ACY1 &lt;dbl&gt;, ADA &lt;dbl&gt;, ADA2 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ADAM15 &lt;dbl&gt;, ADAM23 &lt;dbl&gt;, ADAM8 &lt;dbl&gt;, ADAMTS13 &lt;dbl&gt;, ADAMTS15 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ADAMTS16 &lt;dbl&gt;, ADAMTS8 &lt;dbl&gt;, ADCYAP1R1 &lt;dbl&gt;, ADGRE2 &lt;dbl&gt;, ADGRE5 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ADGRG1 &lt;dbl&gt;, ADGRG2 &lt;dbl&gt;, ADH4 &lt;dbl&gt;, ADM &lt;dbl&gt;, AGER &lt;dbl&gt;, AGR2 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AGR3 &lt;dbl&gt;, AGRN &lt;dbl&gt;, AGRP &lt;dbl&gt;, AGXT &lt;dbl&gt;, AHCY &lt;dbl&gt;, AHSP &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AIF1 &lt;dbl&gt;, AIFM1 &lt;dbl&gt;, AK1 &lt;dbl&gt;, AKR1B1 &lt;dbl&gt;, AKR1C4 &lt;dbl&gt;, ‚Ä¶</span></span></span></code></pre></div>
<p>In this vignette we showed that via HDAnalyzeR the user can impute
their data with different methods, each of them with its own advantages
and drawbacks. The user can choose the method that best fits their data
and their analysis needs. When using KNN or MissForest imputation
methods, the user should experiment with the parameters and look at the
distributions of assays before and after to pick the most suitable.</p>
<blockquote>
<p>üìì Remember that these data are a dummy-dataset with artificial data
and the results in this guide should not be interpreted as real results.
The purpose of this vignette is to show you how to use the package and
its functions.</p>
</blockquote>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez, Emil Johansson, Fredrik Edfors Arfwidsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>





  
</body>
</html>
