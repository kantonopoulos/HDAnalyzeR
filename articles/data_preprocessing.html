<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exploratory Data Analysis ‚Ä¢ HDAnalyzeR</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploratory Data Analysis">
</head>
<body>
<p>








  .github/pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HDAnalyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/HDAnalyzeR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/before_using_hdanalyzer.html">Data Preparation for HDAnalyzeR: What You Need Before Using the Package</a></li>
    <li><a class="dropdown-item" href="../articles/data_preprocessing.html">Exploratory Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/data_imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/differential_expression.html">Differential Expression Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Machine Learning Models</a></li>
    <li><a class="dropdown-item" href="../articles/post_analysis.html">Post Analysis: Pathway Enrichment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kantonopoulos/HDAnalyzeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Exploratory Data Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kantonopoulos/HDAnalyzeR/blob/main/vignettes/data_preprocessing.Rmd" class="external-link"><code>vignettes/data_preprocessing.Rmd</code></a></small>
      <div class="d-none name"><code>data_preprocessing.Rmd</code></div>
    </div>

    
    
<p>This vignette will guide you through the initial steps of a
proteomics pipeline, which is the exploratory data analysis. Except from
HDAnalyzeR we will import viridis for the color palettes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kantonopoulos.github.io/HDAnalyzeR">HDAnalyzeR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>üìì This vignette is just a basic example of how to explore the data
and perform dimensionality reduction to identify potential issues and
trends. However, every dataset is different and may require different
exploration techniques other than the ones contained in the package.</p>
</blockquote>
<blockquote>
<p>‚ö†Ô∏è Please make sure to preprocess the data and metadata before
proceeding with the analysis. For the most common proteomics data
formats, we provide some recommendations in the package documentation
under articles ‚ÄúData Preparation for HDAnalyzeR: What You Need Before
Using the Package‚Äù.</p>
</blockquote>
<div class="section level2">
<h2 id="loading-the-data">Loading the Data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<p>Let‚Äôs start with loading the example data and metadata that come with
the package and initialize the HDAnalyzeR object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_initialize.html">hd_initialize</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">example_data</span>, </span>
<span>                        metadata <span class="op">=</span> <span class="va">example_metadata</span>, </span>
<span>                        is_wide <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                        sample_id <span class="op">=</span> <span class="st">"DAid"</span>,</span>
<span>                        var_name <span class="op">=</span> <span class="st">"Assay"</span>,</span>
<span>                        value_name <span class="op">=</span> <span class="st">"NPX"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploratory-data-analysis">Exploratory Data Analysis<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis"></a>
</h2>
<p>Now, we will perform an automated exploratory data analysis (QC
check) on the data. <code><a href="../reference/hd_qc_summary.html">hd_qc_summary()</a></code> will return the
percentage of missing values for each column and row and histograms of
their distributions both for data and metadata, the variable-variable
(in this case protein-protein) correlation and the metadata variable
distributions.</p>
<blockquote>
<p>‚ö†Ô∏è This should not be confused with the quality control of the data,
which is a different process that is usually performed right after the
proteomics experiments. The exploratory data analysis is a first step to
understand the data and identify potential issues.</p>
</blockquote>
<p>As <code>variable</code> we should pass the column name of the
metadata that contains the different classes, for example the case and
control groups, the different diseases, or the different stages of a
disease. The palettes are optional and can be used to color the plots of
the metadata variable distributions. You should pass a list with the
variable name and the palette name, for example list(Sex = c(‚ÄúF‚Äù =
‚Äúred‚Äù, ‚ÄúM‚Äù = ‚Äúblue‚Äù), Disease = ‚Äúcancers12‚Äù). As you can see, the
palettes can be either a named vector or a character vector with the
name of a palette from the package. You can display all available
HDAnalyzeR palettes by running <code><a href="../reference/hd_show_palettes.html">hd_show_palettes()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_qc_summary.html">hd_qc_summary</a></span><span class="op">(</span><span class="va">hd_obj</span>, </span>
<span>                         variable <span class="op">=</span> <span class="st">"Disease"</span>, </span>
<span>                         palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Disease <span class="op">=</span> <span class="st">"cancers12"</span>, Sex <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>                         cor_threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qc_data</span><span class="op">$</span><span class="va">data_summary</span><span class="op">$</span><span class="va">na_col_hist</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">data_summary</span><span class="op">$</span><span class="va">na_row_hist</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">data_summary</span><span class="op">$</span><span class="va">cor_heatmap</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">metadata_summary</span><span class="op">$</span><span class="va">na_col_hist</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">metadata_summary</span><span class="op">$</span><span class="va">na_row_hist</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-5.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">metadata_summary</span><span class="op">$</span><span class="va">Sex</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-6.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">metadata_summary</span><span class="op">$</span><span class="va">Stage</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-7.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">metadata_summary</span><span class="op">$</span><span class="va">Age</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-8.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qc_data</span><span class="op">$</span><span class="va">metadata_summary</span><span class="op">$</span><span class="va">BMI</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-3-9.png" width="700"></p>
<p>From the EDA results we can see that all assays have less than 10%
missing values, while only a few samples have more than 20% missing
values. The protein-protein correlation plot shows that there are no
extremely highly correlated proteins. Also, the metadata variable
<code>Stage</code> has a high percentage of missing values that are not
correctly stated as NA values but as ‚Äú‚Äù or ‚ÄúUnknown‚Äù. These are only a
few examples of the information that we can extract from the EDA
results.</p>
<p>Based on these we can take decisions on filtering samples with high
missing values, excluding whole assays and metadata variables from
statistical analysis.</p>
</div>
<div class="section level2">
<h2 id="dimensionality-reduction">Dimensionality Reduction<a class="anchor" aria-label="anchor" href="#dimensionality-reduction"></a>
</h2>
<p>Finally we will run a PCA and UMAP analysis on the data to check if
the data contain any outliers or cluster in an unexpected way. From the
PCA analysis we can also check how the variance in the data is explained
by the different principal components. In this example, we will color
the PCA plot based on <code>Disease</code>, while the UMAP plot based on
<code>Age</code>.</p>
<p>The <code><a href="../reference/hd_pca.html">hd_pca()</a></code> and <code><a href="../reference/hd_umap.html">hd_umap()</a></code> functions will
run the respective analysis while the <code><a href="../reference/hd_plot_dim.html">hd_plot_dim()</a></code> will
plot the data on a 2D plane. For the PCA analysis we can also use
<code><a href="../reference/hd_plot_pca_loadings.html">hd_plot_pca_loadings()</a></code> and
<code><a href="../reference/hd_plot_pca_variance.html">hd_plot_pca_variance()</a></code> to plot the loadings of the
different proteins on the principal components and the variance
explained by each principal component respectively.</p>
<p>In the <code><a href="../reference/hd_plot_dim.html">hd_plot_dim()</a></code> function we can pass the
<code>color</code> parameter to color the data points based on a
metadata variable. We should not forget to pass again the hd_obj object
to the <code>metadata</code> argument so the package can search the
metadata and identify the <code>color</code> variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_pca.html">hd_pca</a></span><span class="op">(</span><span class="va">hd_obj</span>, components <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/hd_plot_dim.html">hd_plot_dim</a></span><span class="op">(</span><span class="va">hd_obj</span>, <span class="st">"PC1"</span>, <span class="st">"PC2"</span>, color <span class="op">=</span> <span class="st">"Disease"</span>, palette <span class="op">=</span> <span class="st">"cancers12"</span>, axis_variance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/hd_plot_pca_loadings.html">hd_plot_pca_loadings</a></span><span class="op">(</span>displayed_pcs <span class="op">=</span> <span class="fl">6</span>, displayed_features <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/hd_plot_pca_variance.html">hd_plot_pca_variance</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pca_res</span><span class="op">$</span><span class="va">pca_res</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 √ó 16</span></span></span>
<span><span class="co">#&gt;   DAid     PC1     PC2    PC3    PC4    PC5    PC6     PC7    PC8    PC9    PC10</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DA00‚Ä¶ -<span style="color: #BB0000;">3.67</span>  -<span style="color: #BB0000;">4.28</span>   -<span style="color: #BB0000;">2.34</span>  -<span style="color: #BB0000;">3.10</span>  -<span style="color: #BB0000;">2.65</span>  -<span style="color: #BB0000;">2.73</span>  -<span style="color: #BB0000;">2.78</span>    0.433 -<span style="color: #BB0000;">3.23</span>  -<span style="color: #BB0000;">0.399</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DA00‚Ä¶  4.11  -<span style="color: #BB0000;">2.64</span>    2.04  -<span style="color: #BB0000;">0.441</span> -<span style="color: #BB0000;">4.43</span>  -<span style="color: #BB0000;">1.91</span>  -<span style="color: #BB0000;">0.897</span>   1.54  -<span style="color: #BB0000;">0.283</span>  0.166 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> DA00‚Ä¶ -<span style="color: #BB0000;">3.34</span>   4.72    1.41   0.881 -<span style="color: #BB0000;">0.561</span>  0.308 -<span style="color: #BB0000;">0.061</span><span style="color: #BB0000; text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.267</span>  1.42   0.084<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> DA00‚Ä¶ -<span style="color: #BB0000;">4.78</span>   0.443   1.41   0.107 -<span style="color: #BB0000;">1.10</span>  -<span style="color: #BB0000;">0.262</span>  0.350   3.33  -<span style="color: #BB0000;">0.336</span> -<span style="color: #BB0000;">0.748</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DA00‚Ä¶ -<span style="color: #BB0000;">4.98</span>  -<span style="color: #BB0000;">3.67</span>    0.711 -<span style="color: #BB0000;">5.70</span>  -<span style="color: #BB0000;">0.807</span> -<span style="color: #BB0000;">3.77</span>  -<span style="color: #BB0000;">0.969</span>   1.83  -<span style="color: #BB0000;">1.29</span>  -<span style="color: #BB0000;">0.991</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> DA00‚Ä¶  0.395  0.057<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">1.90</span>  -<span style="color: #BB0000;">7.75</span>   0.707 -<span style="color: #BB0000;">2.70</span>  -<span style="color: #BB0000;">0.681</span>   0.301 -<span style="color: #BB0000;">0.486</span>  1.32  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ‚Ñπ 5 more variables: PC11 &lt;dbl&gt;, PC12 &lt;dbl&gt;, PC13 &lt;dbl&gt;, PC14 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PC15 &lt;dbl&gt;</span></span></span>
<span><span class="va">pca_res</span><span class="op">$</span><span class="va">pca_plot</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_res</span><span class="op">$</span><span class="va">pca_loadings_plot</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_res</span><span class="op">$</span><span class="va">pca_variance_plot</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
<p>This time we want to color based on a continuous variable, the
<code>Age</code>. In this case, we can either bin the data into
categories using <code><a href="../reference/hd_bin_columns.html">hd_bin_columns()</a></code> and use a categorical
palette as before or use a continuous color palette directly after the
plot is created. We will do the second by setting the palette argument
to NULL and using the <code>viridis</code> palette afterwards.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">umap_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_umap.html">hd_umap</a></span><span class="op">(</span><span class="va">hd_obj</span>, components <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/hd_plot_dim.html">hd_plot_dim</a></span><span class="op">(</span><span class="va">hd_obj</span>, <span class="st">"UMAP1"</span>, <span class="st">"UMAP2"</span>, color <span class="op">=</span> <span class="st">"Age"</span>, palette <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">umap_res</span><span class="op">$</span><span class="va">umap_plot</span> <span class="op">+</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_color_viridis</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We can also run a UMAP where the data points are Proteins (or any
feature) instead of samples. The only thing we need to do is to set the
<code>by_sample</code> parameter to <code>FALSE</code> and pass the
<code>Assay</code> column as the <code>plot_color</code> parameter. We
can also pass a custom palette to color the different assays. This time
we will use the wrapper function <code><a href="../reference/hd_auto_umap.html">hd_auto_umap()</a></code>. The
wrapper functions are a bit less flexible but they are easier to use and
require less code.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">umap_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_auto_umap.html">hd_auto_umap</a></span><span class="op">(</span><span class="va">hd_obj</span>, </span>
<span>                         by_sample <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                         plot_color <span class="op">=</span> <span class="st">"Assay"</span>,</span>
<span>                         plot_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADA"</span> <span class="op">=</span> <span class="st">"darkblue"</span>, </span>
<span>                                          <span class="st">"ABL1"</span> <span class="op">=</span> <span class="st">"red3"</span>, </span>
<span>                                          <span class="st">"ACAN"</span> <span class="op">=</span> <span class="st">"green3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">umap_res</span><span class="op">$</span><span class="va">umap_res</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 √ó 3</span></span></span>
<span><span class="co">#&gt;   Assay   UMAP1  UMAP2</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AARSD1  3.50   2.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ABL1    3.19   0.255</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ACAA1   1.90  -<span style="color: #BB0000;">0.679</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ACAN   -<span style="color: #BB0000;">0.488</span> -<span style="color: #BB0000;">1.08</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ACE2    0.330 -<span style="color: #BB0000;">0.343</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> ACOX1  -<span style="color: #BB0000;">1.36</span>  -<span style="color: #BB0000;">1.87</span></span></span>
<span><span class="va">umap_res</span><span class="op">$</span><span class="va">umap_plot</span></span></code></pre></div>
<p><img src="data_preprocessing_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<blockquote>
<p>üìì Remember that these data are a dummy-dataset with artificial data
and the results in this guide should not be interpreted as real results.
The purpose of this vignette is to show you how to use the package and
its functions.</p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] viridis_0.6.5     viridisLite_0.4.2 HDAnalyzeR_0.99.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyselect_1.2.1    timeDate_4041.110   dplyr_1.1.4        </span></span>
<span><span class="co">#&gt;  [4] farver_2.1.2        S7_0.2.0            fastmap_1.2.0      </span></span>
<span><span class="co">#&gt;  [7] janeaustenr_1.0.0   digest_0.6.37       rpart_4.1.24       </span></span>
<span><span class="co">#&gt; [10] timechange_0.3.0    lifecycle_1.0.4     tokenizers_0.3.0   </span></span>
<span><span class="co">#&gt; [13] survival_3.8-3      magrittr_2.0.4      compiler_4.5.1     </span></span>
<span><span class="co">#&gt; [16] rlang_1.1.6         sass_0.4.10         tools_4.5.1        </span></span>
<span><span class="co">#&gt; [19] utf8_1.2.6          yaml_2.3.10         tidytext_0.4.3     </span></span>
<span><span class="co">#&gt; [22] data.table_1.17.8   knitr_1.50          askpass_1.2.1      </span></span>
<span><span class="co">#&gt; [25] labeling_0.4.3      htmlwidgets_1.6.4   reticulate_1.43.0  </span></span>
<span><span class="co">#&gt; [28] RColorBrewer_1.1-3  withr_3.0.2         purrr_1.1.0        </span></span>
<span><span class="co">#&gt; [31] desc_1.4.3          nnet_7.3-20         grid_4.5.1         </span></span>
<span><span class="co">#&gt; [34] embed_1.2.0         future_1.67.0       ggplot2_4.0.0      </span></span>
<span><span class="co">#&gt; [37] globals_0.18.0      scales_1.4.0        MASS_7.3-65        </span></span>
<span><span class="co">#&gt; [40] ggridges_0.5.7      cli_3.6.5           rmarkdown_2.30     </span></span>
<span><span class="co">#&gt; [43] ragg_1.5.0          generics_0.1.4      umap_0.2.10.0      </span></span>
<span><span class="co">#&gt; [46] RSpectra_0.16-2     future.apply_1.20.0 cachem_1.1.0       </span></span>
<span><span class="co">#&gt; [49] splines_4.5.1       parallel_4.5.1      ggplotify_0.1.3    </span></span>
<span><span class="co">#&gt; [52] yulab.utils_0.2.1   vctrs_0.6.5         hardhat_1.4.2      </span></span>
<span><span class="co">#&gt; [55] Matrix_1.7-3        jsonlite_2.0.0      gridGraphics_0.5-1 </span></span>
<span><span class="co">#&gt; [58] listenv_0.9.1       systemfonts_1.3.1   gower_1.0.2        </span></span>
<span><span class="co">#&gt; [61] tidyr_1.3.1         jquerylib_0.1.4     recipes_1.3.1      </span></span>
<span><span class="co">#&gt; [64] glue_1.8.0          parallelly_1.45.1   pkgdown_2.1.3      </span></span>
<span><span class="co">#&gt; [67] codetools_0.2-20    uwot_0.2.3          RcppAnnoy_0.0.22   </span></span>
<span><span class="co">#&gt; [70] stringi_1.8.7       lubridate_1.9.4     gtable_0.3.6       </span></span>
<span><span class="co">#&gt; [73] tibble_3.3.0        pillar_1.11.1       rappdirs_0.3.3     </span></span>
<span><span class="co">#&gt; [76] htmltools_0.5.8.1   openssl_2.3.4       ipred_0.9-15       </span></span>
<span><span class="co">#&gt; [79] lava_1.8.1          R6_2.6.1            textshaping_1.0.3  </span></span>
<span><span class="co">#&gt; [82] evaluate_1.0.5      lattice_0.22-7      png_0.1-8          </span></span>
<span><span class="co">#&gt; [85] backports_1.5.0     SnowballC_0.7.1     pheatmap_1.0.13    </span></span>
<span><span class="co">#&gt; [88] broom_1.0.10        bslib_0.9.0         class_7.3-23       </span></span>
<span><span class="co">#&gt; [91] Rcpp_1.1.0          gridExtra_2.3       prodlim_2025.04.28 </span></span>
<span><span class="co">#&gt; [94] xfun_0.53           fs_1.6.6            tidyheatmaps_0.2.1 </span></span>
<span><span class="co">#&gt; [97] pkgconfig_2.0.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez, Mathias Uhlen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>





  
</body>
</html>
