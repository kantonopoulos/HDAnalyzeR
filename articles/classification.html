<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Machine Learning Models â€¢ HDAnalyzeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="â€image/svg+xmlâ€" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Machine Learning Models">
</head>
<body>
<p>








  pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HDAnalyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/HDAnalyzeR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/before_using_hdanalyzer.html">Data Preparation for HDAnalyzeR: What You Need Before Using the Package</a></li>
    <li><a class="dropdown-item" href="../articles/data_preprocessing.html">Exploratory Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/data_imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/differential_expression.html">Differential Expression Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Machine Learning Models</a></li>
    <li><a class="dropdown-item" href="../articles/post_analysis.html">Post Analysis: Pathway Enrichment &amp; Automated Literature Search</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/HDA1472/HDAnalyzeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Machine Learning Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HDA1472/HDAnalyzeR/blob/main/vignettes/classification.Rmd" class="external-link"><code>vignettes/classification.Rmd</code></a></small>
      <div class="d-none name"><code>classification.Rmd</code></div>
    </div>

    
    
<p>This vignette will show you how you can easily construct machine
learning pipelines using HDAnalyzeR. We will load HDAnalyzeR and dplyr,
load the example data and metadata that come with the package and
initialize the HDAnalyzeR object.</p>
<div class="section level2">
<h2 id="loading-the-data">Loading the Data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hda1472.github.io/HDAnalyzeR">HDAnalyzeR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_initialize.html">hd_initialize</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">example_data</span>, </span>
<span>                        metadata <span class="op">=</span> <span class="va">example_metadata</span>, </span>
<span>                        is_wide <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                        sample_id <span class="op">=</span> <span class="st">"DAid"</span>,</span>
<span>                        var_name <span class="op">=</span> <span class="st">"Assay"</span>,</span>
<span>                        value_name <span class="op">=</span> <span class="st">"NPX"</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>ğŸ““ In the whole vignette the <code>verbose</code> parameter of the
model functions will be set to FALSE in order to keep this guide clean
and concise. However, we recommend to leave it to default (TRUE) in
order to know the modelâ€™s progress and that everything is running
smoothly.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="splitting-the-data">Splitting the Data<a class="anchor" aria-label="anchor" href="#splitting-the-data"></a>
</h2>
<p>First, we will create the data split object using the
<code><a href="../reference/hd_split_data.html">hd_split_data()</a></code> function. This function will create a list
of the train and test sets. We can change the ratio of the train and
test sets, the seed for reproducibility, and the metadata variable to
classify. At this stage, we can also add metadata columns as
predictors.</p>
<p>We will use the <code>Disease</code> column as the variable to
classify and the <code>Sex</code> and <code>Age</code> columns as a
metadata predictor.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_obj</span>, </span>
<span>                           variable <span class="op">=</span> <span class="st">"Disease"</span>, </span>
<span>                           ratio <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                           seed <span class="op">=</span> <span class="fl">123</span>, </span>
<span>                           metadata_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-model">Running the Model<a class="anchor" aria-label="anchor" href="#running-the-model"></a>
</h2>
<div class="section level3">
<h3 id="regularized-regression">Regularized Regression<a class="anchor" aria-label="anchor" href="#regularized-regression"></a>
</h3>
<p>Letâ€™s start with a regularized regression LASSO model via
<code><a href="../reference/hd_model_rreg.html">hd_model_rreg()</a></code>. Exactly like in the previous vignette with
the differential expression functions, we have to state the variable,
case and control(s) groups. To do specifically LASSO we will set the
<code>mixture</code> parameter to 1. We will also set the
<code>verbose</code> parameter to <code>FALSE</code> to not print the
progress of the model in shake of clarity for this vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>,</span>
<span>                           variable <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>                           case <span class="op">=</span> <span class="st">"AML"</span>,</span>
<span>                           control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CLL"</span>, <span class="st">"MYEL"</span>, <span class="st">"GLIOM"</span><span class="op">)</span>,</span>
<span>                           grid_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                           mixture <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                           verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">final_workflow</span></span>
<span><span class="co">#&gt; â•â• Workflow â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> logistic_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Preprocessor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; 5 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â€¢ step_dummy()</span></span>
<span><span class="co">#&gt; â€¢ step_nzv()</span></span>
<span><span class="co">#&gt; â€¢ step_normalize()</span></span>
<span><span class="co">#&gt; â€¢ step_corr()</span></span>
<span><span class="co">#&gt; â€¢ step_impute_knn()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Model â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; Logistic Regression Model Specification (classification)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Arguments:</span></span>
<span><span class="co">#&gt;   penalty = 1.26891735029786e-10</span></span>
<span><span class="co">#&gt;   mixture = mixture</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: glmnet</span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="co">#&gt; $accuracy</span></span>
<span><span class="co">#&gt; [1] 0.7352941</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sensitivity</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $specificity</span></span>
<span><span class="co">#&gt; [1] 0.625</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc</span></span>
<span><span class="co">#&gt; [1] 0.9375</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $confusion_matrix</span></span>
<span><span class="co">#&gt;           Truth</span></span>
<span><span class="co">#&gt; Prediction  0  1</span></span>
<span><span class="co">#&gt;          0 15  0</span></span>
<span><span class="co">#&gt;          1  9 10</span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">roc_curve</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span><span class="op">$</span><span class="va">probability_plot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span><span class="op">$</span><span class="va">feat_imp_plot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<p>We can change several parameters in the <code><a href="../reference/hd_model_rreg.html">hd_model_rreg()</a></code>
function. For example, we can change the number of cross-validation
folds, the number of grid points for the hyperparameter optimization, or
the feature correlation threshold. Also, exactly as with the DE
functions, if the <code>control</code> parameter is not set, the
function will use all the other classes as controls. For more
information, please refer to <code><a href="../reference/hd_model_rreg.html">hd_model_rreg()</a></code>
documentation.</p>
<p>We will also set mixture to NULL to allow the model to optimize this
parameter as well (elastic net regression instead of LASSO) and set a
palette for our classes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>,</span>
<span>                           case <span class="op">=</span> <span class="st">"AML"</span>,</span>
<span>                           cv_sets <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                           grid_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                           cor_threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                           palette <span class="op">=</span> <span class="st">"cancers12"</span>,</span>
<span>                           verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">final_workflow</span></span>
<span><span class="co">#&gt; â•â• Workflow â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> logistic_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Preprocessor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; 5 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â€¢ step_dummy()</span></span>
<span><span class="co">#&gt; â€¢ step_nzv()</span></span>
<span><span class="co">#&gt; â€¢ step_normalize()</span></span>
<span><span class="co">#&gt; â€¢ step_corr()</span></span>
<span><span class="co">#&gt; â€¢ step_impute_knn()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Model â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; Logistic Regression Model Specification (classification)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Arguments:</span></span>
<span><span class="co">#&gt;   penalty = 0.00355590672132398</span></span>
<span><span class="co">#&gt;   mixture = 0.0638105825171806</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: glmnet</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="random-forest">Random Forest<a class="anchor" aria-label="anchor" href="#random-forest"></a>
</h3>
<p>We can use a different variable to classify like <code>Sex</code> and
even a different algorithm like random forest via
<code><a href="../reference/hd_model_rf.html">hd_model_rf()</a></code>. However, do not forget that we should create
a new split object for this new model. In this case, because the classes
are already balanced, we will set the <code>balance_groups</code>
parameter to FALSE to consider all the samples in the training dataset.
Letâ€™s also remove everything except from number of features and AUC from
the variable importance plot title.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_obj</span>, variable <span class="op">=</span> <span class="st">"Sex"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span>                               </span>
<span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rf.html">hd_model_rf</a></span><span class="op">(</span><span class="va">split_obj</span>,</span>
<span>                       variable <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>                       case <span class="op">=</span> <span class="st">"F"</span>,</span>
<span>                       palette <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                       cv_sets <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       grid_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                       balance_groups <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       plot_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"features"</span>, <span class="st">"auc"</span><span class="op">)</span>,</span>
<span>                       verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="logistic-regression">Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h3>
<p>If our data have a single predictor, we can use
<code><a href="../reference/hd_model_lr.html">hd_model_lr()</a></code> instead of <code><a href="../reference/hd_model_rreg.html">hd_model_rreg()</a></code> to
perform a logistic regression. Random forest can be used as it was for
multiple predictors.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hd_obj_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_initialize.html">hd_initialize</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">example_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Assay</span> <span class="op">==</span> <span class="st">"ADA"</span><span class="op">)</span>, </span>
<span>                               metadata <span class="op">=</span> <span class="va">example_metadata</span>, </span>
<span>                               is_wide <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                               sample_id <span class="op">=</span> <span class="st">"DAid"</span>,</span>
<span>                               var_name <span class="op">=</span> <span class="st">"Assay"</span>,</span>
<span>                               value_name <span class="op">=</span> <span class="st">"NPX"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_obj_single</span>, variable <span class="op">=</span> <span class="st">"Disease"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_lr.html">hd_model_lr</a></span><span class="op">(</span><span class="va">split_obj</span>, case <span class="op">=</span> <span class="st">"AML"</span>, palette <span class="op">=</span> <span class="st">"cancers12"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-model-features">Visualizing Model Features<a class="anchor" aria-label="anchor" href="#visualizing-model-features"></a>
</h2>
<p>At this point we should also check how our selected protein features
look in boxplots. We will run a model as before, extract the features,
select the top-9 of them based on their importance in the model and plot
them with <code><a href="../reference/hd_plot_feature_boxplot.html">hd_plot_feature_boxplot()</a></code>. We can either plot
case vs control or case vs all other classes by changing the
<code>type</code> argument.</p>
<blockquote>
<p>âš ï¸ In case you have metadata variables as features, you will have to
remove them from the feature vector before using the
<code><a href="../reference/hd_plot_feature_boxplot.html">hd_plot_feature_boxplot()</a></code> function as it is made to
visualize protein features.</p>
</blockquote>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hd_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_initialize.html">hd_initialize</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">example_data</span>, </span>
<span>                        metadata <span class="op">=</span> <span class="va">example_metadata</span>, </span>
<span>                        is_wide <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                        sample_id <span class="op">=</span> <span class="st">"DAid"</span>,</span>
<span>                        var_name <span class="op">=</span> <span class="st">"Assay"</span>,</span>
<span>                        value_name <span class="op">=</span> <span class="st">"NPX"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_obj</span>, variable <span class="op">=</span> <span class="st">"Disease"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, case <span class="op">=</span> <span class="st">"AML"</span>, cv_sets <span class="op">=</span> <span class="fl">3</span>, grid_size <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="va">model_res</span><span class="op">$</span><span class="va">features</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Scaled_Importance</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Feature</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/hd_plot_feature_boxplot.html">hd_plot_feature_boxplot</a></span><span class="op">(</span><span class="va">hd_obj</span>, </span>
<span>                        features <span class="op">=</span> <span class="va">features</span>, </span>
<span>                        case <span class="op">=</span> <span class="st">"AML"</span>, </span>
<span>                        palette <span class="op">=</span> <span class="st">"cancers12"</span>, </span>
<span>                        type <span class="op">=</span> <span class="st">"case_vs_control"</span>,</span>
<span>                        points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/hd_plot_feature_boxplot.html">hd_plot_feature_boxplot</a></span><span class="op">(</span><span class="va">hd_obj</span>, </span>
<span>                        features <span class="op">=</span> <span class="va">features</span>, </span>
<span>                        case <span class="op">=</span> <span class="st">"AML"</span>, </span>
<span>                        palette <span class="op">=</span> <span class="st">"cancers12"</span>, </span>
<span>                        type <span class="op">=</span> <span class="st">"case_vs_all"</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="multi-classification-model">Multi-classification Model<a class="anchor" aria-label="anchor" href="#multi-classification-model"></a>
</h2>
<p>We can also do multiclassification predictions with all available
classes in the data. The only thing that we should change is set the
<code>case</code> argument to NULL so that the model understands that we
want to classify all the classes. Letâ€™s see an example with regularized
regression!</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, </span>
<span>                           case <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                           cv_sets <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           grid_size <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                           palette <span class="op">=</span> <span class="st">"cancers12"</span>,</span>
<span>                           verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">final_workflow</span></span>
<span><span class="co">#&gt; â•â• Workflow â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> multinom_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Preprocessor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; 5 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â€¢ step_dummy()</span></span>
<span><span class="co">#&gt; â€¢ step_nzv()</span></span>
<span><span class="co">#&gt; â€¢ step_normalize()</span></span>
<span><span class="co">#&gt; â€¢ step_corr()</span></span>
<span><span class="co">#&gt; â€¢ step_impute_knn()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Model â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; Multinomial Regression Model Specification (classification)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Arguments:</span></span>
<span><span class="co">#&gt;   penalty = 0.00445526787557566</span></span>
<span><span class="co">#&gt;   mixture = 0.784269891628064</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: glmnet</span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">roc_curve</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span><span class="op">$</span><span class="va">probability_plot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span><span class="op">$</span><span class="va">feat_imp_plot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="regression-instead-of-classification">Regression instead of Classification<a class="anchor" aria-label="anchor" href="#regression-instead-of-classification"></a>
</h2>
<p>Instead of a classification we can run a regression model. That means
that we will try to predict a continuous variable instead of a
categorical one. We can use either <code><a href="../reference/hd_model_rreg.html">hd_model_rreg()</a></code> or
<code><a href="../reference/hd_model_rf.html">hd_model_rf()</a></code> functions with the <code>case</code>
parameter set to NULL. Letâ€™s see an example with the <code>Age</code>
variable. Do not forget that we have to create a new split object for
this new model with <code>Age</code> as the variable of interest.</p>
<blockquote>
<p>âš ï¸ We should not forget to update the <code>plot_title</code>
argument by changing the metrics from â€œaccuracyâ€, â€œsensitivityâ€,
â€œapwcificityâ€, and â€œaucâ€ to â€œrmseâ€ and â€œrsqâ€.</p>
</blockquote>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_obj</span>, variable <span class="op">=</span> <span class="st">"Age"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, </span>
<span>                           variable <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>                           case <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                           cv_sets <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           grid_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                           plot_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rmse"</span>, <span class="st">"rsq"</span>, <span class="st">"features"</span>, <span class="st">"mixture"</span><span class="op">)</span>,</span>
<span>                           verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">final_workflow</span></span>
<span><span class="co">#&gt; â•â• Workflow â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> linear_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Preprocessor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; 5 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â€¢ step_dummy()</span></span>
<span><span class="co">#&gt; â€¢ step_nzv()</span></span>
<span><span class="co">#&gt; â€¢ step_normalize()</span></span>
<span><span class="co">#&gt; â€¢ step_corr()</span></span>
<span><span class="co">#&gt; â€¢ step_impute_knn()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; â”€â”€ Model â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Arguments:</span></span>
<span><span class="co">#&gt;   penalty = 4.45590449619826e-06</span></span>
<span><span class="co">#&gt;   mixture = 0.220184963848442</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: glmnet</span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">comparison_plot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span><span class="op">$</span><span class="va">feat_imp_plot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="test-the-model-on-new-data">Test the Model on new Data<a class="anchor" aria-label="anchor" href="#test-the-model-on-new-data"></a>
</h2>
<p>Furthermore, we can validate our trained model in new data. For this
example we will not use another dataset, but we will split the data
initially to create a train and a validation set and then split the
train set to an inner train and a test set. We will use this second
split to initially train the model and then evaluate it with the
validation data. In a real case scenario, you can do either this, or use
a completely different dataset to check that the model generalizes
properly. We will use the <code><a href="../reference/hd_model_test.html">hd_model_test()</a></code> function to do
this. Letâ€™s see an example with the AML model.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Split the data for training and validation sets</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">hd_obj</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">train_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">train_indices</span>, <span class="op">]</span></span>
<span><span class="va">validation_data</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="va">train_indices</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">hd_object_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_initialize.html">hd_initialize</a></span><span class="op">(</span><span class="va">train_data</span>, <span class="va">example_metadata</span>, is_wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hd_object_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_initialize.html">hd_initialize</a></span><span class="op">(</span><span class="va">validation_data</span>, <span class="va">example_metadata</span>, is_wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split the training set into training and inner test sets</span></span>
<span><span class="va">split_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_object_train</span>, variable <span class="op">=</span> <span class="st">"Disease"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the regularized regression model pipeline</span></span>
<span><span class="va">model_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>,</span>
<span>                              variable <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>                              case <span class="op">=</span> <span class="st">"AML"</span>,</span>
<span>                              grid_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                              palette <span class="op">=</span> <span class="st">"cancers12"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the model evaluation pipeline</span></span>
<span><span class="va">model_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_test.html">hd_model_test</a></span><span class="op">(</span><span class="va">model_object</span>, </span>
<span>                           <span class="va">hd_object_train</span>, </span>
<span>                           <span class="va">hd_object_val</span>, </span>
<span>                           case <span class="op">=</span> <span class="st">"AML"</span>, </span>
<span>                           palette <span class="op">=</span> <span class="st">"cancers12"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="co">#&gt; $accuracy</span></span>
<span><span class="co">#&gt; [1] 0.8205128</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sensitivity</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $specificity</span></span>
<span><span class="co">#&gt; [1] 0.8018868</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc</span></span>
<span><span class="co">#&gt; [1] 0.9502573</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $confusion_matrix</span></span>
<span><span class="co">#&gt;           Truth</span></span>
<span><span class="co">#&gt; Prediction  0  1</span></span>
<span><span class="co">#&gt;          0 85  0</span></span>
<span><span class="co">#&gt;          1 21 11</span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">test_metrics</span>  <span class="co"># Results from the validation set</span></span>
<span><span class="co">#&gt; $accuracy</span></span>
<span><span class="co">#&gt; [1] 0.8050847</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sensitivity</span></span>
<span><span class="co">#&gt; [1] 0.7777778</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $specificity</span></span>
<span><span class="co">#&gt; [1] 0.8073394</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc</span></span>
<span><span class="co">#&gt; [1] 0.8674822</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $confusion_matrix</span></span>
<span><span class="co">#&gt;           Truth</span></span>
<span><span class="co">#&gt; Prediction  0  1</span></span>
<span><span class="co">#&gt;          0 88  2</span></span>
<span><span class="co">#&gt;          1 21  7</span></span>
<span><span class="va">model_res</span><span class="op">$</span><span class="va">roc_curve</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_res</span><span class="op">$</span><span class="va">test_roc_curve</span>  <span class="co"># Results from the validation set</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="summarizing-results-from-multiple-binary-models">Summarizing Results from Multiple Binary Models<a class="anchor" aria-label="anchor" href="#summarizing-results-from-multiple-binary-models"></a>
</h2>
<p>To summarize the results for multiple binary models we can use the
<code><a href="../reference/hd_plot_model_summary.html">hd_plot_model_summary()</a></code> function. We can create models of
different cases and compare them. Letâ€™s run three different models for
three different cancers and summarize them.</p>
<blockquote>
<p>ğŸ““ Do not forget that Ovarian Cancer is sex specific and we should
consider run the analysis only with samples of that sex. We can easily
integrate that into our pipeline using the
<code><a href="../reference/hd_filter_by_sex.html">hd_filter_by_sex()</a></code> function.</p>
</blockquote>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_obj</span>, variable <span class="op">=</span> <span class="st">"Disease"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_aml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, case <span class="op">=</span> <span class="st">"AML"</span>, cv_sets <span class="op">=</span> <span class="fl">3</span>, grid_size <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_gliom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, case <span class="op">=</span> <span class="st">"GLIOM"</span>, cv_sets <span class="op">=</span> <span class="fl">3</span>, grid_size <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_obj_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_obj</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/hd_filter_by_sex.html">hd_filter_by_sex</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="st">"Sex"</span>, sex <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span>,</span>
<span>                               variable <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>                               ratio <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_ovc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj_sex</span>, case <span class="op">=</span> <span class="st">"OVC"</span>, cv_sets <span class="op">=</span> <span class="fl">3</span>, grid_size <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_summary_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_plot_model_summary.html">hd_plot_model_summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"AML"</span> <span class="op">=</span> <span class="va">model_aml</span>, </span>
<span>                                                <span class="st">"GLIOM"</span> <span class="op">=</span> <span class="va">model_gliom</span>, </span>
<span>                                                <span class="st">"OVC"</span> <span class="op">=</span> <span class="va">model_ovc</span><span class="op">)</span>, </span>
<span>                                           class_palette <span class="op">=</span> <span class="st">"cancers12"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_summary_res</span><span class="op">$</span><span class="va">metrics_barplot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_summary_res</span><span class="op">$</span><span class="va">features_barplot</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_summary_res</span><span class="op">$</span><span class="va">upset_plot_features</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-13-3.png" width="700"></p>
<p>In case we have one case and multiple controls we can use the
<code><a href="../reference/hd_plot_feature_heatmap.html">hd_plot_feature_heatmap()</a></code> function to visualize the protein
features in a heatmap. This function is useful as we can easily see if
the same features are important in multiple models. Letâ€™s see an example
with the AML model and 3 different controls groups. We will combine DE
results of the same comparisons.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, case <span class="op">=</span> <span class="st">"AML"</span>, control <span class="op">=</span> <span class="st">"CLL"</span>, cv_sets <span class="op">=</span> <span class="fl">3</span>, grid_size <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_blood</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, </span>
<span>                             case <span class="op">=</span> <span class="st">"AML"</span>, </span>
<span>                             control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CLL"</span>, <span class="st">"MYEL"</span>, <span class="st">"LYMPH"</span><span class="op">)</span>, </span>
<span>                             cv_sets <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                             grid_size <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">split_obj</span>, case <span class="op">=</span> <span class="st">"AML"</span>, cv_sets <span class="op">=</span> <span class="fl">3</span>, grid_size <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">de_cll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_de_limma.html">hd_de_limma</a></span><span class="op">(</span><span class="va">hd_obj</span>, case <span class="op">=</span> <span class="st">"AML"</span>, control <span class="op">=</span> <span class="st">"CLL"</span>, correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">de_blood</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_de_limma.html">hd_de_limma</a></span><span class="op">(</span><span class="va">hd_obj</span>, </span>
<span>                              case <span class="op">=</span> <span class="st">"AML"</span>, </span>
<span>                              control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CLL"</span>, <span class="st">"MYEL"</span>, <span class="st">"LYMPH"</span><span class="op">)</span>, </span>
<span>                              correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">de_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hd_de_limma.html">hd_de_limma</a></span><span class="op">(</span><span class="va">hd_obj</span>, case <span class="op">=</span> <span class="st">"AML"</span>, correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hd_plot_feature_heatmap.html">hd_plot_feature_heatmap</a></span><span class="op">(</span>de_results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"CLL"</span> <span class="op">=</span> <span class="va">de_cll</span>, </span>
<span>                                          <span class="st">"Blood"</span> <span class="op">=</span> <span class="va">de_blood</span>, </span>
<span>                                          <span class="st">"All"</span> <span class="op">=</span> <span class="va">de_all</span><span class="op">)</span>, </span>
<span>                        model_results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"CLL"</span> <span class="op">=</span> <span class="va">model_cll</span>, </span>
<span>                                             <span class="st">"Blood"</span> <span class="op">=</span> <span class="va">model_blood</span>, </span>
<span>                                             <span class="st">"All"</span> <span class="op">=</span> <span class="va">model_all</span><span class="op">)</span>, </span>
<span>                        order_by <span class="op">=</span> <span class="st">"CLL"</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Finally, we can use the <code><a href="../reference/hd_plot_feature_network.html">hd_plot_feature_network()</a></code>
function to visualize the protein features in a network. This function
is useful as we can easily see the connections between the features and
the importance of each feature in the model. Letâ€™s see an example with
the same 3 models from before.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_panel</span> <span class="op">&lt;-</span> <span class="va">model_aml</span><span class="op">[[</span><span class="st">"features"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Scaled_Importance</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Class <span class="op">=</span> <span class="st">"AML"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">model_gliom</span><span class="op">[[</span><span class="st">"features"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Scaled_Importance</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Class <span class="op">=</span> <span class="st">"GLIOM"</span><span class="op">)</span>,</span>
<span>            <span class="va">model_ovc</span><span class="op">[[</span><span class="st">"features"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Scaled_Importance</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Class <span class="op">=</span> <span class="st">"OVC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">feature_panel</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Preview of the feature panel</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 5</span></span></span>
<span><span class="co">#&gt;   Feature  Importance Sign  Scaled_Importance Class</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ANGPT1        1.31  NEG               1     AML  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ADGRG1        1.02  POS               0.779 AML  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> AMY2A         0.848 POS               0.648 AML  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ADAMTS16      0.788 NEG               0.602 AML  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ADA           0.769 POS               0.587 AML  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> ADAM8         0.721 NEG               0.551 AML</span></span>
<span></span>
<span><span class="fu"><a href="../reference/hd_plot_feature_network.html">hd_plot_feature_network</a></span><span class="op">(</span><span class="va">feature_panel</span>,</span>
<span>                        plot_color <span class="op">=</span> <span class="st">"Scaled_Importance"</span>,</span>
<span>                        class_palette <span class="op">=</span> <span class="st">"cancers12"</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<blockquote>
<p>ğŸ““ Remember that these data are a dummy-dataset with artificial data
and the results in this guide should not be interpreted as real results.
The purpose of this vignette is to show you how to use the package and
its functions.</p>
</blockquote>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez, Emil Johansson, Fredrik Edfors Arfwidsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>





  
</body>
</html>
