<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="hd_ora() performs over-representation analysis (ORA) using the clusterProfiler package."><title>Over-representation analysis — hd_ora • HDAnalyzeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Over-representation analysis — hd_ora"><meta property="og:description" content="hd_ora() performs over-representation analysis (ORA) using the clusterProfiler package."><meta property="og:image" content="https://kantonopoulos.github.io/HDAnalyzeR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body><p>



  .github/pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">HDAnalyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/HDAnalyzeR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/before_using_hdanalyzer.html">Data Preparation for HDAnalyzeR: What You Need Before Using the Package</a>
    <a class="dropdown-item" href="../articles/data_preprocessing.html">Exploratory Data Analysis</a>
    <a class="dropdown-item" href="../articles/data_imputation.html">Data Imputation</a>
    <a class="dropdown-item" href="../articles/differential_expression.html">Differential Expression Analysis</a>
    <a class="dropdown-item" href="../articles/classification.html">Machine Learning Models</a>
    <a class="dropdown-item" href="../articles/post_analysis.html">Post Analysis: Pathway Enrichment</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kantonopoulos/HDAnalyzeR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Over-representation analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/kantonopoulos/HDAnalyzeR/blob/HEAD/R/enrichment_analysis.R" class="external-link"><code>R/enrichment_analysis.R</code></a></small>
      <div class="d-none name"><code>hd_ora.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>hd_ora()</code> performs over-representation analysis (ORA) using the clusterProfiler package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hd_ora</span><span class="op">(</span></span>
<span>  <span class="va">gene_list</span>,</span>
<span>  database <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GO"</span>, <span class="st">"Reactome"</span>, <span class="st">"KEGG"</span><span class="op">)</span>,</span>
<span>  ontology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BP"</span>, <span class="st">"CC"</span>, <span class="st">"MF"</span>, <span class="st">"ALL"</span><span class="op">)</span>,</span>
<span>  background <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pval_lim <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gene_list</dt>
<dd><p>A character vector containing the gene names. These can be differentially expressed proteins or selected protein features from classification models.</p></dd>


<dt>database</dt>
<dd><p>The database to perform the ORA. It can be either "GO", "KEGG", or "Reactome".</p></dd>


<dt>ontology</dt>
<dd><p>The ontology to use when database = "GO". It can be "BP" (Biological Process), "CC" (Cellular Component), "MF" (Molecular Function), or "ALL". In the case of KEGG and Reactome, this parameter is ignored.</p></dd>


<dt>background</dt>
<dd><p>A character vector containing the background genes or a string with the name of the background gene list to use (use <code><a href="hd_show_backgrounds.html">hd_show_backgrounds()</a></code> to see available lists). If NULL, the full proteome is used as background.</p></dd>


<dt>pval_lim</dt>
<dd><p>The p-value threshold to consider a term as significant in the enrichment analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing the results of the ORA.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To perform the ORA, <code>clusterProfiler</code> package is used.
The <code>qvalueCutoff</code> is set to 1 by default to prioritize filtering by adjusted
p-values (p.adjust). This simplifies the workflow by ensuring a single, clear
significance threshold based on the false discovery rate (FDR). While q-values
are not used for filtering by default, they are still calculated and included
in the results for users who wish to apply additional criteria.
For more information, please refer to the <code>clusterProfiler</code> documentation.</p>
<p>If you want to learn more about ORA, please refer to the following publications:</p><ul><li><p>Chicco D, Agapito G. Nine quick tips for pathway enrichment analysis. PLoS Comput Biol. 2022 Aug 11;18(8):e1010348. doi: 10.1371/journal.pcbi.1010348. PMID: 35951505; PMCID: PMC9371296. https://pmc.ncbi.nlm.nih.gov/articles/PMC9371296/</p></li>
<li><p>https://yulab-smu.top/biomedical-knowledge-mining-book/enrichment-overview.html#gsea-algorithm</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Initialize an HDAnalyzeR object</span></span></span>
<span class="r-in"><span><span class="va">hd_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_initialize.html">hd_initialize</a></span><span class="op">(</span><span class="va">example_data</span>, <span class="va">example_metadata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run differential expression analysis for AML vs all others</span></span></span>
<span class="r-in"><span><span class="va">de_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_de_limma.html">hd_de_limma</a></span><span class="op">(</span><span class="va">hd_object</span>, case <span class="op">=</span> <span class="st">"AML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract the up-regulated proteins for AML</span></span></span>
<span class="r-in"><span><span class="va">sig_up_proteins_aml</span> <span class="op">&lt;-</span> <span class="va">de_results</span><span class="op">$</span><span class="va">de_res</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Feature</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform ORA with `GO` database and `BP` ontology</span></span></span>
<span class="r-in"><span><span class="va">enrichment</span> <span class="op">&lt;-</span> <span class="fu">hd_ora</span><span class="op">(</span><span class="va">sig_up_proteins_aml</span>, database <span class="op">=</span> <span class="st">"GO"</span>, ontology <span class="op">=</span> <span class="st">"BP"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No background gene list provided. For meaningful enrichment results, it is recommended to specify a relevant background list of genes (e.g., the full proteome or a set of genes that could be impacted in your experiment). The absence of a background may lead to misleading results in the over-representation analysis (ORA).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'select()' returned 1:1 mapping between keys and columns</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>coercing argument of type 'double' to logical</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">enrichment</span><span class="op">$</span><span class="va">enrichment</span><span class="op">@</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    ID                                   Description GeneRatio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050900 GO:0050900                           leukocyte migration      7/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050926 GO:0050926             regulation of positive chemotaxis      3/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0071674 GO:0071674                    mononuclear cell migration      5/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0001666 GO:0001666                           response to hypoxia      5/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0036293 GO:0036293           response to decreased oxygen levels      5/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0060135 GO:0060135 maternal process involved in female pregnancy      3/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              BgRatio RichFactor FoldEnrichment    zScore       pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050900 397/18860 0.01763224       15.11564  9.713997 2.255163e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050926  26/18860 0.11538462       98.91608 17.073506 3.519968e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0071674 235/18860 0.02127660       18.23985  9.088086 6.375236e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0001666 317/18860 0.01577287       13.52165  7.683419 2.706145e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0036293 330/18860 0.01515152       12.98898  7.508528 3.280154e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0060135  60/18860 0.05000000       42.86364 11.099079 4.515298e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                p.adjust      qvalue                         geneID Count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050900 0.0002753554 0.000166882 100/566/9048/25/2683/199/30817     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050926 0.0021489407 0.001302388                   566/285/9048     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0071674 0.0025947211 0.001572558           566/9048/25/2683/199     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0001666 0.0080101353 0.004854627         100/285/51129/405/1386     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0036293 0.0080101353 0.004854627         100/285/51129/405/1386     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0060135 0.0083253886 0.005045690                  285/181/59272     3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With a background gene list</span></span></span>
<span class="r-in"><span><span class="va">enrichment</span> <span class="op">&lt;-</span> <span class="fu">hd_ora</span><span class="op">(</span><span class="va">sig_up_proteins_aml</span>,</span></span>
<span class="r-in"><span>                     database <span class="op">=</span> <span class="st">"GO"</span>,</span></span>
<span class="r-in"><span>                     ontology <span class="op">=</span> <span class="st">"BP"</span>,</span></span>
<span class="r-in"><span>                     background <span class="op">=</span> <span class="st">"olink_explore_ht"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'select()' returned 1:1 mapping between keys and columns</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'select()' returned 1:1 mapping between keys and columns</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1.51% of input gene IDs are fail to map...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>coercing argument of type 'double' to logical</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">enrichment</span><span class="op">$</span><span class="va">enrichment</span><span class="op">@</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    ID                                   Description GeneRatio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050900 GO:0050900                           leukocyte migration      7/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050926 GO:0050926             regulation of positive chemotaxis      3/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0007186 GO:0007186  G protein-coupled receptor signaling pathway      7/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0001666 GO:0001666                           response to hypoxia      5/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0040012 GO:0040012                      regulation of locomotion      9/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0060135 GO:0060135 maternal process involved in female pregnancy      3/22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             BgRatio RichFactor FoldEnrichment   zScore       pvalue   p.adjust</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050900 210/4812 0.03333333       7.290909 6.317002 2.657681e-05 0.02384161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050926  19/4812 0.15789474      34.535885 9.925311 7.667855e-05 0.02384161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0007186 256/4812 0.02734375       5.980824 5.549969 9.510644e-05 0.02384161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0001666 113/4812 0.04424779       9.678198 6.325973 1.250600e-04 0.02384161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0040012 479/4812 0.01878914       4.109698 4.860186 1.353602e-04 0.02384161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0060135  23/4812 0.13043478      28.529644 8.968160 1.384894e-04 0.02384161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                qvalue                                geneID Count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050900 0.01972001        100/566/9048/25/2683/199/30817     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0050926 0.01972001                          566/285/9048     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0007186 0.01972001         100/566/9289/181/25/976/30817     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0001666 0.01972001                100/285/51129/405/1386     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0040012 0.01972001 100/566/9289/285/9048/25/59/51742/199     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GO:0060135 0.01972001                         285/181/59272     3</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez, Mathias Uhlen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer></div>

  

  

  
</body></html>

