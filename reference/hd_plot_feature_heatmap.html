<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="hd_plot_feature_heatmap plots a summary bubble-heatmap of the combined differential
expression and classification model results. The heatmap shows the log2 fold change
and adjusted p-value of the differential expression results, and the scaled importance
and sign of the classification model results. The heatmap is ordered and the selected
assays are based on the specified control group. * are added to the features that pass
the p-value threshold."><title>Summary the combined DE and model results — hd_plot_feature_heatmap • HDAnalyzeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summary the combined DE and model results — hd_plot_feature_heatmap"><meta property="og:description" content="hd_plot_feature_heatmap plots a summary bubble-heatmap of the combined differential
expression and classification model results. The heatmap shows the log2 fold change
and adjusted p-value of the differential expression results, and the scaled importance
and sign of the classification model results. The heatmap is ordered and the selected
assays are based on the specified control group. * are added to the features that pass
the p-value threshold."><meta property="og:image" content="https://kantonopoulos.github.io/HDAnalyzeR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body><p>



  .github/pkgdown/extra.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">HDAnalyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/HDAnalyzeR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/before_using_hdanalyzer.html">Data Preparation for HDAnalyzeR: What You Need Before Using the Package</a>
    <a class="dropdown-item" href="../articles/data_preprocessing.html">Exploratory Data Analysis</a>
    <a class="dropdown-item" href="../articles/data_imputation.html">Data Imputation</a>
    <a class="dropdown-item" href="../articles/differential_expression.html">Differential Expression Analysis</a>
    <a class="dropdown-item" href="../articles/classification.html">Machine Learning Models</a>
    <a class="dropdown-item" href="../articles/post_analysis.html">Post Analysis: Pathway Enrichment</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kantonopoulos/HDAnalyzeR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Summary the combined DE and model results</h1>
      <small class="dont-index">Source: <a href="https://github.com/kantonopoulos/HDAnalyzeR/blob/HEAD/R/visualize.R" class="external-link"><code>R/visualize.R</code></a></small>
      <div class="d-none name"><code>hd_plot_feature_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>hd_plot_feature_heatmap</code> plots a summary bubble-heatmap of the combined differential
expression and classification model results. The heatmap shows the log2 fold change
and adjusted p-value of the differential expression results, and the scaled importance
and sign of the classification model results. The heatmap is ordered and the selected
assays are based on the specified control group. * are added to the features that pass
the p-value threshold.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hd_plot_feature_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">de_results</span>,</span>
<span>  <span class="va">model_results</span>,</span>
<span>  <span class="va">order_by</span>,</span>
<span>  pval_lim <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  logfc_lim <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>de_results</dt>
<dd><p>A list of differential expression results.</p></dd>


<dt>model_results</dt>
<dd><p>A list of classification models results.</p></dd>


<dt>order_by</dt>
<dd><p>The control group to order the heatmap.</p></dd>


<dt>pval_lim</dt>
<dd><p>The p-value limit to filter the differential expression results of the <code>order_by</code> group.</p></dd>


<dt>logfc_lim</dt>
<dd><p>The log2 fold change limit to filter the differential expression results  of the <code>order_by</code> group.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The summary heatmap of the combined differential expression and classification models results.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It is very important the de_results and model_results are in the same order
and in the right format (see examples).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Initialize an HDAnalyzeR object</span></span></span>
<span class="r-in"><span><span class="va">hd_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_initialize.html">hd_initialize</a></span><span class="op">(</span><span class="va">example_data</span>, <span class="va">example_metadata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run differential expression analysis for AML vs all others</span></span></span>
<span class="r-in"><span><span class="va">de_results_myel</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_de_limma.html">hd_de_limma</a></span><span class="op">(</span><span class="va">hd_object</span>, case <span class="op">=</span> <span class="st">"AML"</span>, control <span class="op">=</span> <span class="st">"MYEL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">de_results_lungc</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_de_limma.html">hd_de_limma</a></span><span class="op">(</span><span class="va">hd_object</span>, case <span class="op">=</span> <span class="st">"AML"</span>, control <span class="op">=</span> <span class="st">"LUNGC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">de_results_gliom</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_de_limma.html">hd_de_limma</a></span><span class="op">(</span><span class="va">hd_object</span>, case <span class="op">=</span> <span class="st">"AML"</span>, control <span class="op">=</span> <span class="st">"GLIOM"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res_de</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"MYEL"</span> <span class="op">=</span> <span class="va">de_results_myel</span>,</span></span>
<span class="r-in"><span>               <span class="st">"LUNGC"</span> <span class="op">=</span> <span class="va">de_results_lungc</span>,</span></span>
<span class="r-in"><span>               <span class="st">"GLIOM"</span> <span class="op">=</span> <span class="va">de_results_gliom</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run Classification models</span></span></span>
<span class="r-in"><span><span class="co"># Split the data into training and test sets</span></span></span>
<span class="r-in"><span><span class="va">hd_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_split_data.html">hd_split_data</a></span><span class="op">(</span><span class="va">hd_object</span>, variable <span class="op">=</span> <span class="st">"Disease"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Too little data to stratify.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Resampling will be unstratified.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the regularized regression model pipeline</span></span></span>
<span class="r-in"><span><span class="va">model_results_myel</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">hd_split</span>,</span></span>
<span class="r-in"><span>                                    variable <span class="op">=</span> <span class="st">"Disease"</span>,</span></span>
<span class="r-in"><span>                                    case <span class="op">=</span> <span class="st">"AML"</span>,</span></span>
<span class="r-in"><span>                                    control <span class="op">=</span> <span class="st">"MYEL"</span>,</span></span>
<span class="r-in"><span>                                    grid_size <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                    cv_sets <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                    verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The groups in the train set are balanced. If you do not want to balance the groups, set `balance_groups = FALSE`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model_results_lungc</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">hd_split</span>,</span></span>
<span class="r-in"><span>                                     variable <span class="op">=</span> <span class="st">"Disease"</span>,</span></span>
<span class="r-in"><span>                                     case <span class="op">=</span> <span class="st">"AML"</span>,</span></span>
<span class="r-in"><span>                                     control <span class="op">=</span> <span class="st">"LUNGC"</span>,</span></span>
<span class="r-in"><span>                                     grid_size <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                     cv_sets <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The groups in the train set are balanced. If you do not want to balance the groups, set `balance_groups = FALSE`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model_results_gliom</span> <span class="op">&lt;-</span> <span class="fu"><a href="hd_model_rreg.html">hd_model_rreg</a></span><span class="op">(</span><span class="va">hd_split</span>,</span></span>
<span class="r-in"><span>                                     variable <span class="op">=</span> <span class="st">"Disease"</span>,</span></span>
<span class="r-in"><span>                                     case <span class="op">=</span> <span class="st">"AML"</span>,</span></span>
<span class="r-in"><span>                                     control <span class="op">=</span> <span class="st">"GLIOM"</span>,</span></span>
<span class="r-in"><span>                                     grid_size <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                     cv_sets <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The groups in the train set are balanced. If you do not want to balance the groups, set `balance_groups = FALSE`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The models are in the same order as the DE results</span></span></span>
<span class="r-in"><span><span class="va">res_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"MYEL"</span> <span class="op">=</span> <span class="va">model_results_myel</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"LUNGC"</span> <span class="op">=</span> <span class="va">model_results_lungc</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"GLIOM"</span> <span class="op">=</span> <span class="va">model_results_gliom</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create the summary heatmap</span></span></span>
<span class="r-in"><span><span class="fu">hd_plot_feature_heatmap</span><span class="op">(</span><span class="va">res_de</span>, <span class="va">res_model</span>, order_by <span class="op">=</span> <span class="st">"MYEL"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="hd_plot_feature_heatmap-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez, Mathias Uhlen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer></div>

  

  

  
</body></html>

